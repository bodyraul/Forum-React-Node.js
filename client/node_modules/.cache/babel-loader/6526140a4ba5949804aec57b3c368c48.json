{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/aurel/OneDrive/Bureau/projetfinal2/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/aurel/OneDrive/Bureau/projetfinal2/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/aurel/OneDrive/Bureau/projetfinal2/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from'react';import{useContext}from'react';import{AuthContext}from\"../../Context/AuthContext\";import{Link}from'react-router-dom';import{useEffect}from'react';import axios from'axios';import{useState}from'react';import\"./navbar.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Navbar(props){var _useContext=useContext(AuthContext),token=_useContext.token,settoken=_useContext.settoken;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),pseudo=_useState2[0],setpseudo=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),admin=_useState4[0],setadmin=_useState4[1];var config={headers:{Authorization:\"Bearer \".concat(token)}};var adminOuNon=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/admin\",config).then(function(res){if(res.data!='admin'){return setadmin(false);}setadmin(true);}).catch(function(err){return setadmin(false);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function adminOuNon(){return _ref.apply(this,arguments);};}();useEffect(function(){adminOuNon();},[props.test]);useEffect(function(){var config={headers:{Authorization:\"Bearer \".concat(token)}};if(token){axios.get(\"/user/recupPseudo\",config).then(function(res){return setpseudo(res.data);}).catch(function(err){return console.log(err);});}if(!token){return;}},[token]);if(token){return/*#__PURE__*/_jsxs(\"nav\",{className:\"navbar\",children:[/*#__PURE__*/_jsx(Link,{className:\"premierLink\",to:\"/\",children:\"Accueil \"}),/*#__PURE__*/_jsx(Link,{className:\"deuxiemeLink\",to:\"/forum\",children:\"forum \"}),/*#__PURE__*/_jsx(Link,{className:\"troisiemeLink\",onClick:function onClick(){localStorage.removeItem(\"token\");settoken(\"\");setadmin(false);props.settest(false);},to:\"/#/connexion\",children:\"Deconnexion \"}),admin===true?/*#__PURE__*/_jsx(Link,{className:\"quatriemeLink\",to:\"/admin\",children:\"admin \"}):\"\",/*#__PURE__*/_jsx(\"p\",{id:\"pseudoNavbar\",children:pseudo})]});}if(!token){return/*#__PURE__*/_jsxs(\"nav\",{className:\"navbar\",children:[/*#__PURE__*/_jsx(Link,{className:\"premierLink\",to:\"/\",children:\"Accueil \"}),/*#__PURE__*/_jsx(Link,{className:\"deuxiemeLink\",to:\"/forum\",children:\"forum \"}),/*#__PURE__*/_jsx(Link,{className:\"troisiemeLink\",to:\"/connexion\",children:\"Connexion \"}),/*#__PURE__*/_jsx(Link,{className:\"quatriemeLink\",to:\"/inscription\",children:\"Inscription \"})]});}}","map":{"version":3,"names":["React","useContext","AuthContext","Link","useEffect","axios","useState","Navbar","props","token","settoken","pseudo","setpseudo","admin","setadmin","config","headers","Authorization","adminOuNon","get","then","res","data","catch","err","test","console","log","localStorage","removeItem","settest"],"sources":["C:/Users/aurel/OneDrive/Bureau/projetfinal2/client/src/Component/navbar/Navbar.jsx"],"sourcesContent":["import React from 'react'\r\nimport { useContext } from 'react';\r\nimport { AuthContext } from\"../../Context/AuthContext\"\r\nimport { Link } from 'react-router-dom';\r\nimport { useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useState } from 'react';\r\nimport \"./navbar.css\";\r\n\r\nexport default function Navbar(props) {\r\n    const { token,settoken } = useContext(AuthContext);\r\n    const [pseudo, setpseudo] = useState(\"\");\r\n    const [admin, setadmin] = useState(false);\r\n    const config = {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`,\r\n      },\r\n    };\r\n\r\n     const adminOuNon = async ()=>{\r\n        await axios.get(\"/admin\",config)\r\n        .then((res)=>{\r\n          if(res.data != 'admin'){\r\n            return setadmin(false);\r\n            \r\n          }\r\n          setadmin(true);\r\n        })\r\n        .catch((err)=>(setadmin(false)))\r\n      }\r\n\r\n    useEffect(() => {\r\n        adminOuNon();\r\n\r\n    }, [props.test])\r\n    \r\n\r\n    useEffect(() => {\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      };\r\n\r\n      if(token){\r\n        axios.get(\"/user/recupPseudo\",config)\r\n        .then((res)=>setpseudo(res.data))\r\n        .catch((err)=>console.log(err));\r\n      }      \r\n      if(!token){\r\n        return;\r\n      }\r\n    }, [token])\r\n    \r\n    if(token) {\r\n      return(\r\n        <nav className='navbar'>\r\n          <Link className='premierLink' to={\"/\"}>Accueil </Link>\r\n          <Link className='deuxiemeLink' to={\"/forum\"}>forum </Link>\r\n          <Link className='troisiemeLink' onClick={()=>{\r\n            localStorage.removeItem(\"token\");\r\n            settoken(\"\");\r\n            setadmin(false);\r\n            props.settest(false);\r\n        }} to={\"/#/connexion\"}>Deconnexion </Link>\r\n          {admin===true? <Link className='quatriemeLink' to={\"/admin\"}>admin </Link> : \"\"}\r\n          <p id='pseudoNavbar'>{pseudo}</p>\r\n        </nav>\r\n     )\r\n    }if(!token){\r\n      return(\r\n        <nav className='navbar'>\r\n          <Link className='premierLink' to={\"/\"}>Accueil </Link>\r\n          <Link className='deuxiemeLink'  to={\"/forum\"}>forum </Link>\r\n          <Link className='troisiemeLink'  to={\"/connexion\"}>Connexion </Link>\r\n          <Link className='quatriemeLink'  to={\"/inscription\"}>Inscription </Link>\r\n        \r\n        </nav>\r\n     )\r\n    }\r\n      \r\n  }\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}